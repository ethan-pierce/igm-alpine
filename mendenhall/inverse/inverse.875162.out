2023-02-27 13:41:45.176711: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-02-27 13:41:45.369652: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2023-02-27 13:41:45.382546: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2794880000 Hz
/projects/etpi5866/igm/src/igm.py:3157: RuntimeWarning: invalid value encountered in divide
  costs[:, i] /= np.max(costs[:, i])
/projects/etpi5866/software/anaconda/envs/igm/lib/python3.8/site-packages/numpy/core/fromnumeric.py:3432: RuntimeWarning: Mean of empty slice.
  return _methods._mean(a, axis=axis, dtype=dtype,
/projects/etpi5866/software/anaconda/envs/igm/lib/python3.8/site-packages/numpy/core/_methods.py:190: RuntimeWarning: invalid value encountered in double_scalars
  ret = ret.dtype.type(ret / rcount)
Build IGM class
+++++++++++++++++++ START IGM ++++++++++++++++++++++++++++++++++++++++++
PARAMETERS ARE ...... 
                   working_dir : 
                  geology_file : geology.nc
                      resample : 1
                        tstart : 0.0
                          tend : 100.0
                restartingfile : 
                     verbosity : 0
                         tsave : 10
                   plot_result : False
                     plot_live : False
                        usegpu : True
                          stop : False
              init_strflowctrl : 78
                init_slidingco : 0
                init_arrhenius : 78
                            dz : 20
                        maxthk : 1000.0
              clim_update_freq : 1
                  type_climate : 
               erosion_include : False
                   erosion_cst : 2.7e-07
                   erosion_exp : 2
           erosion_update_freq : 100
                uplift_include : False
                   uplift_rate : 0.002
            uplift_update_freq : 100
        iceflow_model_lib_path : /projects/etpi5866/igm/model-lib/f15_cfsflow_GJ_22_a/50
          multiple_window_size : 0
              force_max_velbar : 0
                      optimize : False
             opti_vars_to_save : ['topg', 'usurf', 'thk', 'strflowctrl', 'arrhenius', 'slidingco', 'velsurf_mag', 'velsurfobs_mag', 'divflux']
              observation_file : ./inputs/observation.nc
             thk_profiles_file : 
                     mode_opti : thkstrflowctrl
          opti_thr_strflowctrl : 78.0
            opti_init_zero_thk : False
           opti_regu_param_thk : 10
   opti_regu_param_strflowctrl : 10
 opti_smooth_anisotropy_factor : 0.2
         opti_convexity_weight : 0.002
             opti_usurfobs_std : 15
          opti_strflowctrl_std : 5.0
           opti_velsurfobs_std : 1
               opti_thkobs_std : 15
           opti_divfluxobs_std : 1.0
                  opti_control : ['thk', 'strflowctrl', 'usurf']
                     opti_cost : ['velsurf', 'thk', 'usurf', 'icemask']
                  opti_nbitmin : 50
                  opti_nbitmax : 2000
                opti_step_size : 0.001
       opti_make_holes_in_data : 0
              opti_output_freq : 50
        geology_optimized_file : geology-optimized.nc
                  vars_to_save : ['topg', 'usurf', 'thk', 'smb', 'velbar_mag', 'velsurf_mag']
                       varplot : velbar_mag
                   varplot_max : 500
                mb_update_freq : 1
             type_mass_balance : simple
                    mb_scaling : 1.0
                mb_simple_file : mb_simple_param.txt
            smb_model_lib_path : ../../model-lib/smb_meteoswissglamos
    smoothing_thk_filter_shape : 3
           smoothing_thk_sigma : 3
     smoothing_thk_update_freq : 100
                           cfl : 0.3
                         dtmax : 10.0
               tracking_method : 3d
             frequency_seeding : 10
               density_seeding : 0.2
 OPTI, step     0 , ICE_VOL:    0.00 , COST_U:  302.04 , COST_H:   68.89 , COST_D :    0.00 , COST_S :    0.00 , REGU_H :    0.00 , REGU_A :    0.00 
 OPTI, step    50 , ICE_VOL:    6.77 , COST_U:  303.08 , COST_H:   43.89 , COST_D :    0.00 , COST_S :    0.01 , REGU_H :  -22.28 , REGU_A :    0.00 
 OPTI, step   100 , ICE_VOL:   10.83 , COST_U:  302.90 , COST_H:   30.91 , COST_D :    0.00 , COST_S :    0.04 , REGU_H :  -33.78 , REGU_A :    0.02 
 OPTI, step   150 , ICE_VOL:   13.98 , COST_U:  298.10 , COST_H:   23.70 , COST_D :    0.00 , COST_S :    0.09 , REGU_H :  -41.68 , REGU_A :    0.12 
 OPTI, step   200 , ICE_VOL:   16.55 , COST_U:  289.13 , COST_H:   19.70 , COST_D :    0.00 , COST_S :    0.16 , REGU_H :  -47.37 , REGU_A :    0.30 
 OPTI, step   250 , ICE_VOL:   18.73 , COST_U:  275.26 , COST_H:   17.45 , COST_D :    0.00 , COST_S :    0.24 , REGU_H :  -51.04 , REGU_A :    0.63 
 OPTI, step   300 , ICE_VOL:   20.53 , COST_U:  254.37 , COST_H:   16.31 , COST_D :    0.00 , COST_S :    0.33 , REGU_H :  -53.20 , REGU_A :    1.04 
 OPTI, step   350 , ICE_VOL:   22.01 , COST_U:  233.83 , COST_H:   15.76 , COST_D :    0.00 , COST_S :    0.42 , REGU_H :  -55.07 , REGU_A :    1.25 
 OPTI, step   400 , ICE_VOL:   23.24 , COST_U:  214.33 , COST_H:   15.55 , COST_D :    0.00 , COST_S :    0.50 , REGU_H :  -56.87 , REGU_A :    1.39 
 OPTI, step   450 , ICE_VOL:   24.27 , COST_U:  197.48 , COST_H:   15.64 , COST_D :    0.00 , COST_S :    0.58 , REGU_H :  -58.52 , REGU_A :    1.48 
 OPTI, step   500 , ICE_VOL:   25.12 , COST_U:  183.05 , COST_H:   15.82 , COST_D :    0.00 , COST_S :    0.66 , REGU_H :  -60.58 , REGU_A :    1.55 
 OPTI, step   550 , ICE_VOL:   25.81 , COST_U:  173.22 , COST_H:   16.00 , COST_D :    0.00 , COST_S :    0.74 , REGU_H :  -62.86 , REGU_A :    1.55 
 OPTI, step   600 , ICE_VOL:   26.41 , COST_U:  165.03 , COST_H:   16.17 , COST_D :    0.00 , COST_S :    0.81 , REGU_H :  -64.85 , REGU_A :    1.54 
 OPTI, step   650 , ICE_VOL:   26.94 , COST_U:  157.72 , COST_H:   16.31 , COST_D :    0.00 , COST_S :    0.88 , REGU_H :  -66.72 , REGU_A :    1.52 
 OPTI, step   700 , ICE_VOL:   27.42 , COST_U:  150.36 , COST_H:   16.41 , COST_D :    0.00 , COST_S :    0.95 , REGU_H :  -68.33 , REGU_A :    1.53 
 OPTI, step   750 , ICE_VOL:   27.83 , COST_U:  143.26 , COST_H:   16.46 , COST_D :    0.00 , COST_S :    1.01 , REGU_H :  -69.72 , REGU_A :    1.54 
 OPTI, step   800 , ICE_VOL:   28.20 , COST_U:  136.25 , COST_H:   16.52 , COST_D :    0.00 , COST_S :    1.08 , REGU_H :  -70.90 , REGU_A :    1.56 
 OPTI, step   850 , ICE_VOL:   28.53 , COST_U:  130.48 , COST_H:   16.56 , COST_D :    0.00 , COST_S :    1.13 , REGU_H :  -72.45 , REGU_A :    1.54 
 OPTI, step   900 , ICE_VOL:   28.84 , COST_U:  125.00 , COST_H:   16.58 , COST_D :    0.00 , COST_S :    1.19 , REGU_H :  -73.80 , REGU_A :    1.48 
 OPTI, step   950 , ICE_VOL:   29.11 , COST_U:  120.25 , COST_H:   16.56 , COST_D :    0.00 , COST_S :    1.24 , REGU_H :  -75.12 , REGU_A :    1.43 
 OPTI, step  1000 , ICE_VOL:   29.35 , COST_U:  116.33 , COST_H:   16.54 , COST_D :    0.00 , COST_S :    1.30 , REGU_H :  -76.46 , REGU_A :    1.40 
 OPTI, step  1050 , ICE_VOL:   29.56 , COST_U:  112.49 , COST_H:   16.50 , COST_D :    0.00 , COST_S :    1.35 , REGU_H :  -77.75 , REGU_A :    1.38 
 OPTI, step  1100 , ICE_VOL:   29.77 , COST_U:  108.85 , COST_H:   16.46 , COST_D :    0.00 , COST_S :    1.40 , REGU_H :  -78.94 , REGU_A :    1.36 
 OPTI, step  1150 , ICE_VOL:   29.97 , COST_U:  105.18 , COST_H:   16.45 , COST_D :    0.00 , COST_S :    1.45 , REGU_H :  -80.06 , REGU_A :    1.34 
 OPTI, step  1200 , ICE_VOL:   30.18 , COST_U:  101.60 , COST_H:   16.45 , COST_D :    0.00 , COST_S :    1.49 , REGU_H :  -81.11 , REGU_A :    1.34 
 OPTI, step  1250 , ICE_VOL:   30.38 , COST_U:   98.33 , COST_H:   16.44 , COST_D :    0.00 , COST_S :    1.54 , REGU_H :  -82.12 , REGU_A :    1.33 
 OPTI, step  1300 , ICE_VOL:   30.56 , COST_U:   95.42 , COST_H:   16.44 , COST_D :    0.00 , COST_S :    1.59 , REGU_H :  -83.09 , REGU_A :    1.32 
 OPTI, step  1350 , ICE_VOL:   30.73 , COST_U:   92.79 , COST_H:   16.44 , COST_D :    0.00 , COST_S :    1.63 , REGU_H :  -84.05 , REGU_A :    1.30 
 OPTI, step  1400 , ICE_VOL:   30.89 , COST_U:   89.95 , COST_H:   16.42 , COST_D :    0.00 , COST_S :    1.67 , REGU_H :  -84.91 , REGU_A :    1.27 
 OPTI, step  1450 , ICE_VOL:   31.05 , COST_U:   86.97 , COST_H:   16.41 , COST_D :    0.00 , COST_S :    1.71 , REGU_H :  -85.84 , REGU_A :    1.25 
 OPTI, step  1500 , ICE_VOL:   31.21 , COST_U:   84.35 , COST_H:   16.41 , COST_D :    0.00 , COST_S :    1.75 , REGU_H :  -86.75 , REGU_A :    1.21 
 OPTI, step  1550 , ICE_VOL:   31.36 , COST_U:   81.57 , COST_H:   16.38 , COST_D :    0.00 , COST_S :    1.79 , REGU_H :  -87.64 , REGU_A :    1.16 
 OPTI, step  1600 , ICE_VOL:   31.50 , COST_U:   79.19 , COST_H:   16.35 , COST_D :    0.00 , COST_S :    1.83 , REGU_H :  -88.70 , REGU_A :    1.11 
 OPTI, step  1650 , ICE_VOL:   31.65 , COST_U:   76.85 , COST_H:   16.34 , COST_D :    0.00 , COST_S :    1.86 , REGU_H :  -89.60 , REGU_A :    1.07 
 OPTI, step  1700 , ICE_VOL:   31.79 , COST_U:   74.54 , COST_H:   16.34 , COST_D :    0.00 , COST_S :    1.90 , REGU_H :  -90.46 , REGU_A :    1.03 
 OPTI, step  1750 , ICE_VOL:   31.93 , COST_U:   72.45 , COST_H:   16.35 , COST_D :    0.00 , COST_S :    1.93 , REGU_H :  -91.33 , REGU_A :    1.00 
 OPTI, step  1800 , ICE_VOL:   32.05 , COST_U:   70.27 , COST_H:   16.35 , COST_D :    0.00 , COST_S :    1.96 , REGU_H :  -92.10 , REGU_A :    0.97 
 OPTI, step  1850 , ICE_VOL:   32.19 , COST_U:   68.18 , COST_H:   16.37 , COST_D :    0.00 , COST_S :    1.99 , REGU_H :  -92.88 , REGU_A :    0.95 
 OPTI, step  1900 , ICE_VOL:   32.31 , COST_U:   66.04 , COST_H:   16.37 , COST_D :    0.00 , COST_S :    2.02 , REGU_H :  -93.66 , REGU_A :    0.91 
 OPTI, step  1950 , ICE_VOL:   32.43 , COST_U:   64.11 , COST_H:   16.40 , COST_D :    0.00 , COST_S :    2.05 , REGU_H :  -94.42 , REGU_A :    0.89 
Computational statistics report:
                 All  |  mean time per it :      nan  |  total :   0.0000  |  number it  :        0
            Optimize  |  mean time per it :   1.6446  |  total : 3285.9910  |  number it  :     1998
