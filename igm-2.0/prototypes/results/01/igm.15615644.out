2023-07-26 09:45:34.787474: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-07-26 09:45:37.576391: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory
2023-07-26 09:45:37.576417: I tensorflow/compiler/xla/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2023-07-26 09:45:52.307368: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory
2023-07-26 09:45:52.307721: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory
2023-07-26 09:45:52.307732: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
rm: cannot remove ‘clean.sh’: No such file or directory
2023-07-26 09:46:20.710538: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory
2023-07-26 09:46:20.710571: W tensorflow/compiler/xla/stream_executor/cuda/cuda_driver.cc:265] failed call to cuInit: UNKNOWN ERROR (303)
2023-07-26 09:46:20.710588: I tensorflow/compiler/xla/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (bnode0503.rc.int.colorado.edu): /proc/driver/nvidia/version does not exist
2023-07-26 09:46:20.727393: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
/projects/etpi5866/igm2/igm/modules/physics/optimize.py:735: RuntimeWarning: invalid value encountered in divide
  costs[:, i] /= np.max(costs[:, i])
/projects/etpi5866/software/anaconda/envs/igm2/lib/python3.10/site-packages/numpy/core/fromnumeric.py:3504: RuntimeWarning: Mean of empty slice.
  return _methods._mean(a, axis=axis, dtype=dtype,
/projects/etpi5866/software/anaconda/envs/igm2/lib/python3.10/site-packages/numpy/core/_methods.py:129: RuntimeWarning: invalid value encountered in scalar divide
  ret = ret.dtype.type(ret / rcount)
PARAMETERS ARE ...... 
                   working_dir : 
                 logging_level : CRITICAL
                  logging_file : igm.log
                  geology_file : geology.nc
                      resample : 1
                     crop_data : False
                     crop_xmin : None
                     crop_xmax : None
                     crop_ymin : None
                     crop_ymax : None
             opti_vars_to_save : ['usurf', 'thk', 'slidingco', 'velsurf_mag', 'velsurfobs_mag', 'divflux', 'icemask']
            opti_init_zero_thk : False
           opti_regu_param_thk : 10
     opti_regu_param_slidingco : 10
 opti_smooth_anisotropy_factor : 0.2
         opti_convexity_weight : 0
             opti_usurfobs_std : 2.0
           opti_velsurfobs_std : 2.0
               opti_thkobs_std : 3.0
           opti_divfluxobs_std : 1.0
                  opti_control : ['thk']
                     opti_cost : ['velsurf', 'icemask']
                  opti_nbitmin : 50
                  opti_nbitmax : 1000
                opti_step_size : 1
              opti_output_freq : 50
        geology_optimized_file : geology-optimized.nc
         plot2d_live_inversion : True
              plot2d_inversion : True
           write_ncdf_optimize : True
        editor_plot2d_optimize : vs
                  type_iceflow : emulated
                      emulator : f21_pinnbp_GJ_23_a
               iceflow_physics : 2
                init_slidingco : 10000
                init_arrhenius : 78
                     regu_glen : 1e-05
                 regu_weertman : 1e-10
                      exp_glen : 3
                  exp_weertman : 3
                            Nz : 10
                  vert_spacing : 4.0
                   thr_ice_thk : 0.1
       solve_iceflow_step_size : 1
         solve_iceflow_nbitmax : 100
           stop_if_no_decrease : True
                       fieldin : ['thk', 'usurf', 'arrhenius', 'slidingco', 'dX']
 retrain_iceflow_emulator_freq : 10
   retrain_iceflow_emulator_lr : 2e-05
 retrain_iceflow_emulator_nbit : 1
retrain_iceflow_emulator_framesizemax : 750
          multiple_window_size : 0
              force_max_velbar : 0
                       network : cnn
                    activation : lrelu
                     nb_layers : 16
                     nb_blocks : 4
                 nb_out_filter : 32
                 conv_ker_size : 3
                  dropout_rate : 0
                        tstart : 2000.0
                          tend : 2000.0
                         tsave : 50
                           cfl : 0.3
                         dtmax : 10.0
                     plot_live : True
                   observation : True
               opti_velobs_std : 1.0
                   Step  |  ICE_VOL |  COST_U  |  COST_H  |  COST_D  |  COST_S  |   REGU_H |   REGU_S | COST_GLEN  
OPTI 09:46:29 :        0 |    24.83 |   1792.01 |     0.00 |     0.00 |     0.00 |   508.06 |     0.00 |     6.30 |
OPTI 09:50:43 :       50 |    22.97 |   223.01 |     0.00 |     0.00 |     0.00 |   309.94 |     0.00 |    -0.96 |
OPTI 09:54:57 :      100 |    20.88 |   190.83 |     0.00 |     0.00 |     0.00 |   252.14 |     0.00 |    -0.65 |
OPTI 09:59:09 :      150 |    18.83 |   162.63 |     0.00 |     0.00 |     0.00 |   206.26 |     0.00 |    -0.46 |
OPTI 10:03:27 :      200 |    16.94 |   145.10 |     0.00 |     0.00 |     0.00 |   174.59 |     0.00 |    -0.34 |
OPTI 10:07:44 :      250 |    15.25 |   130.86 |     0.00 |     0.00 |     0.00 |   150.31 |     0.00 |    -0.26 |
OPTI 10:12:02 :      300 |    13.87 |   123.28 |     0.00 |     0.00 |     0.00 |   132.00 |     0.00 |    -0.22 |
OPTI 10:16:23 :      350 |    12.72 |   119.81 |     0.00 |     0.00 |     0.00 |   119.59 |     0.00 |    -0.19 |
OPTI 10:20:42 :      400 |    11.72 |   117.62 |     0.00 |     0.00 |     0.00 |   110.11 |     0.00 |    -0.17 |
OPTI 10:27:07 :      450 |    10.86 |   116.26 |     0.00 |     0.00 |     0.00 |   102.48 |     0.00 |    -0.15 |
OPTI 10:34:50 :      500 |    10.07 |   115.73 |     0.00 |     0.00 |     0.00 |    96.90 |     0.00 |    -0.14 |
OPTI 10:42:18 :      550 |     9.34 |   115.39 |     0.00 |     0.00 |     0.00 |    92.68 |     0.00 |    -0.12 |
OPTI 10:49:44 :      600 |     8.64 |   115.15 |     0.00 |     0.00 |     0.00 |    88.74 |     0.00 |    -0.11 |
OPTI 10:57:13 :      650 |     7.99 |   114.85 |     0.00 |     0.00 |     0.00 |    86.20 |     0.00 |    -0.10 |
OPTI 11:04:45 :      700 |     7.41 |   114.51 |     0.00 |     0.00 |     0.00 |    84.72 |     0.00 |    -0.10 |
OPTI 11:12:07 :      750 |     6.93 |   114.19 |     0.00 |     0.00 |     0.00 |    84.06 |     0.00 |    -0.09 |
OPTI 11:19:07 :      800 |     6.56 |   114.17 |     0.00 |     0.00 |     0.00 |    84.06 |     0.00 |    -0.09 |
OPTI 11:25:59 :      850 |     6.28 |   114.40 |     0.00 |     0.00 |     0.00 |    83.95 |     0.00 |    -0.09 |
OPTI 11:31:41 :      900 |     6.06 |   114.57 |     0.00 |     0.00 |     0.00 |    83.92 |     0.00 |    -0.09 |
OPTI 11:37:09 :      950 |     5.88 |   114.67 |     0.00 |     0.00 |     0.00 |    83.42 |     0.00 |    -0.09 |
IGM %s :         Iterations   |         Time (y)     |     Time Step (y)   |   Ice Volume (km^3) 
Computational statistics report:
                      iceflow  |  mean time per it :      nan  |  total :   0.0000  |  number it  :        0
                     optimize  |  mean time per it :   6.9673  |  total : 6967.2975  |  number it  :     1000
                    time_step  |  mean time per it :      nan  |  total :   0.0000  |  number it  :        0
                          thk  |  mean time per it :      nan  |  total :   0.0000  |  number it  :        0
             vertical_iceflow  |  mean time per it :      nan  |  total :   0.0000  |  number it  :        0
