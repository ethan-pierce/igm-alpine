2023-07-26 13:48:00.584674: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-07-26 13:48:00.991617: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory
2023-07-26 13:48:00.991648: I tensorflow/compiler/xla/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2023-07-26 13:48:03.508835: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory
2023-07-26 13:48:03.508913: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory
2023-07-26 13:48:03.508923: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
rm: cannot remove ‘clean.sh’: No such file or directory
2023-07-26 13:48:08.122560: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory
2023-07-26 13:48:08.122601: W tensorflow/compiler/xla/stream_executor/cuda/cuda_driver.cc:265] failed call to cuInit: UNKNOWN ERROR (303)
2023-07-26 13:48:08.122623: I tensorflow/compiler/xla/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (bnode0503.rc.int.colorado.edu): /proc/driver/nvidia/version does not exist
2023-07-26 13:48:08.123191: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
/projects/etpi5866/igm2/igm/modules/physics/optimize.py:735: RuntimeWarning: invalid value encountered in divide
  costs[:, i] /= np.max(costs[:, i])
/projects/etpi5866/software/anaconda/envs/igm2/lib/python3.10/site-packages/numpy/core/fromnumeric.py:3504: RuntimeWarning: Mean of empty slice.
  return _methods._mean(a, axis=axis, dtype=dtype,
/projects/etpi5866/software/anaconda/envs/igm2/lib/python3.10/site-packages/numpy/core/_methods.py:129: RuntimeWarning: invalid value encountered in scalar divide
  ret = ret.dtype.type(ret / rcount)
PARAMETERS ARE ...... 
                   working_dir : 
                 logging_level : CRITICAL
                  logging_file : igm.log
                  geology_file : geology.nc
                      resample : 1
                     crop_data : False
                     crop_xmin : None
                     crop_xmax : None
                     crop_ymin : None
                     crop_ymax : None
             opti_vars_to_save : ['usurf', 'thk', 'slidingco', 'velsurf_mag', 'velsurfobs_mag', 'divflux', 'icemask']
            opti_init_zero_thk : False
           opti_regu_param_thk : 10
     opti_regu_param_slidingco : 10
 opti_smooth_anisotropy_factor : 0.2
         opti_convexity_weight : 0
             opti_usurfobs_std : 2.0
           opti_velsurfobs_std : 2.0
               opti_thkobs_std : 3.0
           opti_divfluxobs_std : 1.0
                  opti_control : ['thk', 'slidingco']
                     opti_cost : ['velsurf', 'icemask']
                  opti_nbitmin : 50
                  opti_nbitmax : 1000
                opti_step_size : 1
              opti_output_freq : 50
        geology_optimized_file : geology-optimized.nc
         plot2d_live_inversion : True
              plot2d_inversion : True
           write_ncdf_optimize : True
        editor_plot2d_optimize : vs
                  type_iceflow : emulated
                      emulator : f21_pinnbp_GJ_23_a
               iceflow_physics : 2
                init_slidingco : 10000
                init_arrhenius : 78
                     regu_glen : 1e-05
                 regu_weertman : 1e-10
                      exp_glen : 3
                  exp_weertman : 3
                            Nz : 10
                  vert_spacing : 4.0
                   thr_ice_thk : 0.1
       solve_iceflow_step_size : 1
         solve_iceflow_nbitmax : 100
           stop_if_no_decrease : True
                       fieldin : ['thk', 'usurf', 'arrhenius', 'slidingco', 'dX']
 retrain_iceflow_emulator_freq : 10
   retrain_iceflow_emulator_lr : 2e-05
 retrain_iceflow_emulator_nbit : 1
retrain_iceflow_emulator_framesizemax : 750
          multiple_window_size : 0
              force_max_velbar : 0
                       network : cnn
                    activation : lrelu
                     nb_layers : 16
                     nb_blocks : 4
                 nb_out_filter : 32
                 conv_ker_size : 3
                  dropout_rate : 0
                        tstart : 2000.0
                          tend : 2000.0
                         tsave : 50
                           cfl : 0.3
                         dtmax : 10.0
                     plot_live : True
                   observation : True
               opti_velobs_std : 1.0
                   Step  |  ICE_VOL |  COST_U  |  COST_H  |  COST_D  |  COST_S  |   REGU_H |   REGU_S | COST_GLEN  
OPTI 13:48:18 :        0 |    24.83 |   1792.01 |     0.00 |     0.00 |     0.00 |   508.06 |     0.00 |     6.30 |
OPTI 13:55:32 :       50 |    23.11 |   166.13 |     0.00 |     0.00 |     0.00 |   298.85 |    18.70 |    -0.56 |
OPTI 14:02:20 :      100 |    21.11 |   170.64 |     0.00 |     0.00 |     0.00 |   251.21 |    22.18 |    -0.48 |
OPTI 14:09:28 :      150 |    19.12 |   153.13 |     0.00 |     0.00 |     0.00 |   211.52 |    18.08 |    -0.38 |
OPTI 14:16:55 :      200 |    17.35 |   143.42 |     0.00 |     0.00 |     0.00 |   181.33 |    13.01 |    -0.31 |
OPTI 14:24:28 :      250 |    15.80 |   136.31 |     0.00 |     0.00 |     0.00 |   158.38 |     9.07 |    -0.26 |
OPTI 14:31:41 :      300 |    14.45 |   130.06 |     0.00 |     0.00 |     0.00 |   142.41 |     6.39 |    -0.22 |
OPTI 14:37:35 :      350 |    13.26 |   125.54 |     0.00 |     0.00 |     0.00 |   129.34 |     4.87 |    -0.19 |
OPTI 14:43:02 :      400 |    12.19 |   121.41 |     0.00 |     0.00 |     0.00 |   117.11 |     3.93 |    -0.17 |
OPTI 14:48:28 :      450 |    11.26 |   118.43 |     0.00 |     0.00 |     0.00 |   107.77 |     3.60 |    -0.16 |
OPTI 14:53:54 :      500 |    10.43 |   116.52 |     0.00 |     0.00 |     0.00 |    99.73 |     3.60 |    -0.14 |
OPTI 14:59:09 :      550 |     9.66 |   116.50 |     0.00 |     0.00 |     0.00 |    89.46 |     3.69 |    -0.12 |
OPTI 15:04:00 :      600 |     8.92 |   115.09 |     0.00 |     0.00 |     0.00 |    88.91 |     3.77 |    -0.13 |
OPTI 15:09:19 :      650 |     8.28 |   114.22 |     0.00 |     0.00 |     0.00 |    87.74 |     3.52 |    -0.13 |
OPTI 15:14:41 :      700 |     7.72 |   114.12 |     0.00 |     0.00 |     0.00 |    86.47 |     3.18 |    -0.12 |
OPTI 15:19:54 :      750 |     7.24 |   114.17 |     0.00 |     0.00 |     0.00 |    83.92 |     2.99 |    -0.12 |
OPTI 15:25:06 :      800 |     6.79 |   114.28 |     0.00 |     0.00 |     0.00 |    82.11 |     2.75 |    -0.11 |
OPTI 15:30:32 :      850 |     6.43 |   114.50 |     0.00 |     0.00 |     0.00 |    81.07 |     2.65 |    -0.10 |
OPTI 15:35:57 :      900 |     6.11 |   114.64 |     0.00 |     0.00 |     0.00 |    78.63 |     2.63 |    -0.10 |
OPTI 15:41:21 :      950 |     5.85 |   114.93 |     0.00 |     0.00 |     0.00 |    77.20 |     2.64 |    -0.10 |
IGM %s :         Iterations   |         Time (y)     |     Time Step (y)   |   Ice Volume (km^3) 
Computational statistics report:
                      iceflow  |  mean time per it :      nan  |  total :   0.0000  |  number it  :        0
                     optimize  |  mean time per it :   7.0996  |  total : 7099.6462  |  number it  :     1000
                    time_step  |  mean time per it :      nan  |  total :   0.0000  |  number it  :        0
                          thk  |  mean time per it :      nan  |  total :   0.0000  |  number it  :        0
             vertical_iceflow  |  mean time per it :      nan  |  total :   0.0000  |  number it  :        0
